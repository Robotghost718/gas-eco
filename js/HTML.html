<script>
  /* exported HTML */
  const HTML = (function () {
    return {
      attributes,
      createElement,
      empty,
      getFirstChild,
      getNextSibling,
      makeRadio,
      getRadioValue,
    };

    function attributes(el, attrs) {
      for (const key in attrs) {
        if (key === "class") el.classList.add(...attrs[key].split(/\s+/));
        else if (key === "removeClass") el.classList.remove(attrs[key]);
        else if (key === "child") el.appendChild(attrs[key]);
        else if (key === "children")
          attrs[key].forEach((child) => el.appendChild(child));
        else if (key === "innerHTML") el.innerHTML = attrs[key];
        else if (key === "textContent") el.textContent = attrs[key];
        else if (key === "onClick") el.addEventListener("click", attrs[key]);
        else if (["selected", "checked"].includes(key)) {
          // only create attribute if true
          attrs[key] && el.setAttribute(key, attrs[key]);
        } else el.setAttribute(key, attrs[key]);
      }
      return el;
    }

    function createElement(name, attrs) {
      return attributes(document.createElement(name), attrs);
    }

    function empty(el) {
      while (el && el.firstChild) el.removeChild(el.firstChild);
    }

    function getFirstChild(element) {
      let firstChild = element.firstChild;
      while (firstChild != null && firstChild.nodeType == 3) {
        firstChild = firstChild.nextSibling;
      }
      return firstChild;
    }

    function getNextSibling(element) {
      let nextSibling = element.nextSibling;
      while (nextSibling != null && nextSibling.nodeType == 3) {
        nextSibling = nextSibling.nextSibling;
      }
      return nextSibling;
    }

    function makeRadio({ name, values, checked }) {
      return values.reduce(
        (radio, value) => ({
          ...radio,
          [value]: createElement("input", {
            type: "radio",
            name,
            value,
            checked: value === checked,
          }),
        }),
        {}
      );
    }

    function getRadioValue(container = document) {
      const found = Array.from(
        container.querySelectorAll('input[type="radio"]')
      ).find((el) => el.checked);
      return found ? found.value : null;
    }
  })();
</script>
