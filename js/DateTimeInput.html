<script>
  /* global DateUtils HTML Utility */
  /* exported DateTimeInput */
  function DateTimeInput({ name, value, onChange }) {
    const date = DateUtils.parseFormattedDate(
      value || DateUtils.getFormattedDate(new Date())
    );
    // const _onChange = () =>
    const inputs = [
      HTML.createElement("input", {
        type: "date",
        name: `${name}Date`,
        autocomplete: "off",
        placeholder: "mm/dd/yyyy",
        value: DateUtils.formatDashed(date),
      }),
      HTML.select({
        name: `${name}Hour`,
        children: Utility.range(12, 1).map((option) => HTML.option(option)),
        value: DateUtils.parseHours(date.getHours()),
      }),
      document.createTextNode(":"),
      HTML.select({
        name: `${name}Minute`,
        children: Utility.range(12, 0, 5).map((n) =>
          HTML.createElement("option", {
            textContent: String(n).padStart(2, "0"),
            value: n,
          })
        ),
        value: DateUtils.roundMinutes(date.getMinutes()),
      }),
      HTML.select({
        name: `${name}AMPM`,
        children: ["AM", "PM"].map((option) => HTML.option(option)),
        value: DateUtils.parseAMPM(date.getHours()),
      }),
    ];
    inputs.forEach((input) =>
      input.addEventListener("change", (event) => {
        onChange({
          event,
          name,
          values: {
            date: inputs[0].value,
            hour: inputs[1].value,
            minutes: inputs[3].value,
            ampm: inputs[4].value,
          },
        });
      })
    );
    return inputs;
  }
</script>
