<script>
  "use strict";
  /* global Utility */
  /* exported Item */
  class Item {
    constructor({
      barcode = "",
      description = "",
      id = "",
      missing = false,
      notes = "",
      timeCheckedInByClient = "",
      timeCheckedInByServer = "",
      timeCheckedOutByClient = "",
      timeCheckedOutByServer = "",
    }) {
      this.barcode = String(barcode);
      this.description = String(description);
      this.id = String(id);
      this.missing = Boolean(missing);
      this.notes = String(notes);
      this.timeCheckedInByClient = timeCheckedInByClient;
      this.timeCheckedInByServer = timeCheckedInByServer;
      this.timeCheckedOutByClient = timeCheckedOutByClient;
      this.timeCheckedOutByServer = timeCheckedOutByServer;

      return Object.freeze(this);
    }

    isSerialized() {
      return this.barcode && (+this.barcode < 10000 || +this.barcode > 10100);
    }

    // item has been reserved in advance on the form, it has no time info
    isReserved() {
      return !this.timeCheckedOutByClient;
    }

    isStagedForOut() {
      return this.timeCheckedOutByClient && !this.timeCheckedOutByServer;
    }

    isOut() {
      return this.timeCheckedOutByServer && !this.timeCheckedInByClient;
    }

    isStagedForIn() {
      return this.timeCheckedInByClient && !this.timeCheckedInByServer;
    }

    isIn() {
      return this.timeCheckedInByServer;
    }

    static getManualPrefix() {
      return "MANUAL-";
    }

    static isManualEntryId(id) {
      return new RegExp("^" + Item.getManualPrefix()).test(id);
    }

    static getManualEntryId(hash) {
      return Item.getManualPrefix() + Utility.hexString(hash).substring(0, 5);
    }

    static similar(a, b) {
      return (
        a.barcode === b.barcode &&
        a.id === b.id &&
        a.description === b.description
      );
    }
  }
</script>
