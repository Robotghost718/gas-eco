<script>
  /* global toast */
  /* exported Utility */
  const Utility = (function () {
    return {
      copyToClipboard,
      digestMessage,
      hexString,
      tryJsonParse,
      uncamelCase,
    };

    function copyToClipboard(data) {
      const textArea = document.createElement("textarea");
      // ensures that copying the items will not cause the screen to scroll down
      textArea.setAttribute("readonly", true);
      textArea.value = data;
      document.body.appendChild(textArea);
      textArea.select();
      document.execCommand("copy"); //! execCommand is deprecated, migrate to ClipboardAPI
      toast("Items copied");
      // removes the text area after copying so that it is not seen
      document.body.removeChild(textArea);
    }

    function digestMessage(message) {
      const encoder = new TextEncoder();
      const data = encoder.encode(message);
      return window.crypto.subtle.digest("SHA-1", data);
    }

    function hexString(buffer) {
      const byteArray = new Uint8Array(buffer);
      const hexCodes = [...byteArray].map((value) => {
        const hexCode = value.toString(16);
        const paddedHexCode = hexCode.padStart(2, "0");
        return paddedHexCode;
      });
      return hexCodes.join("");
    }

    function tryJsonParse(string) {
      try {
        return JSON.parse(string);
      } catch (error) {
        return null;
      }
    }

    function uncamelCase(string) {
      return string
        .replace(/([A-Z])/g, " $1")
        .replace(/^./, (str) => str.toUpperCase());
    }
  })();
</script>
